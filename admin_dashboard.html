<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - Gym10</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-50 min-h-screen">
    <!-- Navbar -->
    <nav class="bg-black">
      <div
        class="container mx-auto flex items-center justify-between py-4 px-6"
      >
        <div class="flex items-center gap-3">
          <img
            src="img/logo.jpg"
            alt="Gym10 Logo"
            class="h-10 w-10 rounded-full"
          />
          <span class="text-xl font-bold text-green-400">Gym10</span>
        </div>
        <ul class="flex gap-6">
          <li>
            <a
              href="logout.php"
              class="ml-4 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition"
              >Logout</a
            >
          </li>
        </ul>
      </div>
    </nav>

    <main class="container mx-auto py-10">
      <h1 class="text-3xl font-bold mb-8 text-center text-green-600">
        Admin Dashboard
      </h1>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <!-- User Management -->
        <div class="bg-white rounded-lg shadow p-6">
          <h2 class="text-xl font-bold mb-4 text-green-600">User Management</h2>
          <div class="overflow-x-auto">
            <table class="min-w-full table-auto border">
              <thead>
                <tr class="bg-gray-100">
                  <th class="px-4 py-2">User ID</th>
                  <th class="px-4 py-2">Name</th>
                  <th class="px-4 py-2">Email</th>
                  <th class="px-4 py-2">Status</th>
                  <th class="px-4 py-2">Actions</th>
                </tr>
              </thead>
              <tbody id="user-table-body">
                <tr>
                  <td colspan="5" class="text-center py-4">Loading users...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <!-- Membership Management -->
        <div class="bg-white rounded-lg shadow p-6">
          <h2 class="text-xl font-bold mb-4 text-green-600">
            Membership Plans
          </h2>
          <div class="overflow-x-auto">
            <table class="min-w-full table-auto border">
              <thead>
                <tr class="bg-gray-100">
                  <th class="px-4 py-2">Plan ID</th>
                  <th class="px-4 py-2">Plan Name</th>
                  <th class="px-4 py-2">Price</th>
                  <th class="px-4 py-2">Actions</th>
                </tr>
              </thead>
              <tbody id="plan-table-body">
                <tr>
                  <td colspan="4" class="text-center py-4">Loading plans...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <!-- Add more admin sections as needed -->
    </main>

    <footer class="bg-black text-white py-6 mt-10">
      <div class="container mx-auto text-center">
        &copy; 2024 Gym10 - All Rights Reserved
      </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      // Load users and plans via AJAX
      $(function () {
        $.get(
          "admindashboard.php",
          function (data) {
            // Users
            let userRows = "";
            if (data.users && data.users.length > 0) {
              data.users.forEach(function (user) {
                userRows += `
              <tr>
                <td class="px-4 py-2">${user.ClientID}</td>
                <td class="px-4 py-2">${user.Name}</td>
                <td class="px-4 py-2">${user.Email}</td>
                <td class="px-4 py-2">${user.Role || "User"}</td>
                <td class="px-4 py-2 space-x-2">
                  <button class="px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition" onclick="editUser(${
                    user.ClientID
                  }, '${user.Name}', '${user.Email}', '${
                  user.Phone || ""
                }')">Edit</button>
                  <button class="px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition" onclick="deleteUser(${
                    user.ClientID
                  })">Delete</button>
                </td>
              </tr>
            `;
              });
            } else {
              userRows = `<tr><td colspan="5" class="text-center py-4">No users found.</td></tr>`;
            }
            $("#user-table-body").html(userRows);

            // Plans
            let planRows = "";
            if (data.plans && data.plans.length > 0) {
              data.plans.forEach(function (plan) {
                planRows += `
              <tr>
                <td class="px-4 py-2">${plan.PlanTypeID}</td>
                <td class="px-4 py-2">${plan.PlanName}</td>
                <td class="px-4 py-2">Rs ${plan.Price}</td>
                <td class="px-4 py-2 space-x-2">
                  <button class="px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition" onclick="editPlan(${plan.PlanTypeID}, '${plan.PlanName}', '${plan.Price}')">Edit</button>
                  <button class="px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition" onclick="deletePlan(${plan.PlanTypeID})">Delete</button>
                </td>
              </tr>
            `;
              });
            } else {
              planRows = `<tr><td colspan="4" class="text-center py-4">No plans found.</td></tr>`;
            }
            $("#plan-table-body").html(planRows);
          },
          "json"
        );
      });

      // Example edit/delete functions (replace with your AJAX logic)
      function editUser(id, name, email, phone) {
        const newName = prompt("Edit name:", name);
        const newEmail = prompt("Edit email:", email);
        const newPhone = prompt("Edit phone:", phone);
        if (newName && newEmail) {
          $.post(
            "admindashboard.php",
            {
              action: "edit_user",
              client_id: id,
              name: newName,
              email: newEmail,
              phone: newPhone,
            },
            function (resp) {
              alert(resp.message);
              location.reload();
            },
            "json"
          );
        }
      }
      function deleteUser(id) {
        if (confirm("Are you sure you want to delete this user?")) {
          $.post(
            "admindashboard.php",
            { action: "delete_user", client_id: id },
            function (resp) {
              alert(resp.message);
              location.reload();
            },
            "json"
          );
        }
      }
      function editPlan(id, name, price) {
        const newName = prompt("Edit plan name:", name);
        const newPrice = prompt("Edit price:", price);
        if (newName && newPrice) {
          $.post(
            "admindashboard.php",
            {
              action: "edit_plan",
              plan_type_id: id,
              plan_name: newName,
              price: newPrice,
            },
            function (resp) {
              alert(resp.message);
              location.reload();
            },
            "json"
          );
        }
      }
      function deletePlan(id) {
        if (confirm("Are you sure you want to delete this plan?")) {
          $.post(
            "admindashboard.php",
            { action: "delete_plan", plan_type_id: id },
            function (resp) {
              alert(resp.message);
              location.reload();
            },
            "json"
          );
        }
      }
    </script>
  </body>
</html>
